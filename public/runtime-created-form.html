<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Runtime-Created Form</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #f97316, #0ea5e9);
      padding: 40px 16px;
      min-height: 100vh;
    }
    .page {
      max-width: 760px;
      margin: 0 auto;
      background: #fff7ed;
      border-radius: 18px;
      padding: 28px 24px 36px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.25);
    }
    h1 { font-size: 24px; margin-bottom: 6px; color: #7c2d12; }
    .subtitle { font-size: 14px; color: #9a3412; margin-bottom: 18px; }
    .placeholder {
      background: #fffbeb;
      border-radius: 14px;
      border: 1px dashed #fed7aa;
      padding: 16px 14px 18px;
      font-size: 13px;
      color: #7c2d12;
    }
  </style>
</head>
<body>
<div class="page">
  <a href="/labs" style="display:inline-block;margin-bottom:12px;color:#9a3412;text-decoration:none;font-size:13px;">‚Üê Back to Form Labs</a>
  <h1>Runtime-Created Form</h1>
  <p class="subtitle">Tests scanners that capture raw HTML vs. the DOM after JavaScript execution.</p>

  <div id="formMount" class="placeholder">
    JavaScript will inject a full form here after page load.
  </div>
</div>

<script>
(function() {
  const mount = document.getElementById('formMount');

  const form = document.createElement('form');
  form.id = 'runtimeForm';

  const nameLabel = document.createElement('label');
  nameLabel.textContent = 'Name *';
  nameLabel.htmlFor = 'rt_name';
  const nameInput = document.createElement('input');
  nameInput.id = 'rt_name';
  nameInput.name = 'name';
  nameInput.required = true;

  const emailLabel = document.createElement('label');
  emailLabel.textContent = 'Email *';
  emailLabel.htmlFor = 'rt_email';
  const emailInput = document.createElement('input');
  emailInput.id = 'rt_email';
  emailInput.name = 'email';
  emailInput.type = 'email';
  emailInput.required = true;

  const btn = document.createElement('button');
  btn.type = 'submit';
  btn.textContent = 'Submit runtime form';

  const msg = document.createElement('div');
  msg.id = 'rt_message';
  msg.style.marginTop = '10px';
  msg.style.fontSize = '13px';

  form.appendChild(nameLabel);
  form.appendChild(nameInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(emailLabel);
  form.appendChild(emailInput);
  form.appendChild(document.createElement('br'));
  form.appendChild(btn);
  form.appendChild(msg);

  mount.innerHTML = '';
  mount.appendChild(form);

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const data = Object.fromEntries(new FormData(form).entries());
    msg.textContent = 'Submitting...';
    try {
      const res = await fetch('/api/submit-runtime-created-form', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });
      const result = await res.json();
      msg.textContent = result.success ? 'Submitted OK' : 'Error from server';
    } catch (err) {
      msg.textContent = 'Network error while submitting';
    }
  });
})();
</script>
</body>
</html>
